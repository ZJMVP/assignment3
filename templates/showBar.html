<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        .navigation-bar {
            width: 100%;
            height: 40px;
            background-color: #436283;
        }

        .navigation-bar a {
            display: block;
            font-size: 20px;
            color: white;
            text-decoration: none;
            height: 40px;
            width: 2.5rem;
            line-height: 40px;
            margin-left: 20px;
        }

        .form-con {
            margin-top: 20px;
        }

    </style>
    <script src="https://d3js.org/d3.v5.min.js" charset="utf-8"></script>
</head>
<body>
<div class="navigation-bar">
    <a href="/">Home</a>
</div>
<div class="form-con">
    Tuples:
    <input type="text" name="tuple" id="tuple"/><br/>
    <button onclick="draw_bar()">draw a bar</button>
</div>
<svg id="chart"></svg>
<script>
    function draw_bar() {
        var tuple = document.getElementById("tuple").value;
        var data = tuple.split(",") // 使用逗号分隔字符串，并得到子字符串数组
            .map(item => ({label: item.match(/[a-zA-Z]/g).join(""), count: item.match(/\d/g).join("")}));
        data.sort((a, b) => b.count - a.count);

        // Set up svg dimensions and margins
        const svgWidth = window.innerWidth * 0.7;
        const svgHeight = data.length * 30; // Adjust as needed
        const margin = {top: 20, right: 20, bottom: 20, left: 200};
        const width = svgWidth - margin.left - margin.right;
        const height = svgHeight - margin.top - margin.bottom;

        // Create the SVG element
        const svg = d3.select("#chart")
            .attr("width", svgWidth)
            .attr("height", svgHeight)
            .append("g")
            .attr("transform", `translate(${margin.left}, ${margin.top})`);

        // Create the x-scale
        const xScale = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.count)])
            .range([0, width]);

        // Create the y-scale
        const yScale = d3.scaleBand()
            .domain(data.map(d => d.label))
            .range([0, height])
            .padding(0.2);

        // Create and append the bars
        svg.selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("x", 0)
            .attr("y", d => yScale(d.label))
            .attr("width", d => xScale(d.count))
            .attr("height", yScale.bandwidth())
            .attr("fill", "red");

        // Add labels to the left of each bar
        svg.selectAll("text")
            .data(data)
            .enter()
            .append("text")
            .attr("x", -10) // Position to the left of the bar
            .attr("y", d => yScale(d.label) + (yScale.bandwidth() / 2)) // Vertically center the label
            .attr("dy", "0.35em")
            .text(d => d.label);

        // Add count values to the right of each bar
        svg.selectAll(".count")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "count")
            .attr("x", d => xScale(d.count) + 10) // Position to the right of the bar
            .attr("y", d => yScale(d.label) + (yScale.bandwidth() / 2)) // Vertically center the count
            .attr("dy", "0.35em")
            .text(d => d.count);

    }
</script>
</body>
</html>